.. _csharp-aggregation-lookup:

======
Lookup
======

.. facet::
   :name: genre
   :values: reference

.. meta::
   :keywords: code example, transform, pipeline

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol


Lookup
------

Use the ``lookup()`` method to create a :manual:`$lookup </reference/operator/aggregation/lookup/>`
pipeline stage to perform joins and uncorrelated subqueries between two collections.

Left Outer Join
~~~~~~~~~~~~~~~

The following example creates a pipeline stage that performs a left outer
join between the ``movies`` and ``comments`` collections:

- It joins the ``_id`` field from ``movies`` to the ``movie_id`` field in ``comments``
- It outputs the results in the ``joined_comments`` field:

.. literalinclude:: /includes/aggregation/Builders.cs
   :start-after: // begin basic lookup
   :end-before: // end basic lookup
   :language: csharp
   :dedent:

Full Join and Uncorrelated Subqueries
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The following example creates a pipeline stage that joins two collections, ``orders``
and ``warehouses``, by the item and whether the available quantity is enough
to fulfill the ordered quantity:

.. literalinclude:: /includes/aggregation/Builders.cs
   :start-after: // begin advanced lookup
   :end-before: // end advanced lookup
   :language: csharp
   :dedent:
